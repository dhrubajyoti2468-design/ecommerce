{% extends "base.html" %}
{% block content %}
<div class="card" style="max-width:800px;margin:0 auto">
  <img src="{{ product.img }}" alt="{{ product.name }}" style="height:260px;object-fit:contain">
  <h2>{{ product.name }}</h2>
  <div class="price">â‚¹{{ product.price }}</div>
  <div class="cat">{{ product.category }}</div>

  {% if product.ratings and product.ratings|length > 0 %}
    {% set numeric = product.ratings|map('int')|list %}
    {% set avg = (numeric|sum) / (numeric|length) %}
    <div class="rating">Average: {{ '%.1f'|format(avg) }} ({{ numeric|length }} ratings)</div>
  {% else %}
    <div class="rating">No ratings yet</div>
  {% endif %}

  <form method="post" style="margin-top:16px">
    <label>Rate this product:
      <select name="rating">
        <option value="1">1</option><option value="2">2</option>
        <option value="3">3</option><option value="4">4</option>
        <option value="5">5</option>
      </select>
    </label>
    <button class="btn" type="submit">Submit Rating</button>
  </form>

  <div style="margin-top:18px">
    <a class="btn" href="{{ url_for('add_to_cart', pid=product.id) }}">Add to Cart</a>
    <a class="btn btn-outline" href="{{ url_for('wishlist_add', pid=product.id) }}">Add to Wishlist</a>
  </div>
</div>
{% endblock %}
